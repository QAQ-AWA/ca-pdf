# ca-pdf é¡¹ç›®å¼€å‘è·¯çº¿å›¾ä¸ä»»åŠ¡ç»†åˆ†

---

## ğŸ“‹ åŠŸèƒ½å®Œæˆåº¦é€Ÿè§ˆè¡¨

### åç«¯ API ç«¯ç‚¹çŠ¶æ€

| æ¨¡å— | ç«¯ç‚¹ | çŠ¶æ€ | å®ç°åº¦ | å¤‡æ³¨ |
|------|------|------|--------|------|
| **è®¤è¯** | `POST /api/v1/auth/login` | âœ… å®Œæˆ | 100% | JWTè®¤è¯ |
| | `POST /api/v1/auth/logout` | âœ… å®Œæˆ | 100% | TokenåŠé”€ |
| | `POST /api/v1/auth/refresh` | âœ… å®Œæˆ | 100% | Tokenè½®æ¢ |
| | `GET /api/v1/auth/me` | âœ… å®Œæˆ | 100% | ç”¨æˆ·èµ„æ–™ |
| | `GET /api/v1/auth/admin/ping` | âœ… å®Œæˆ | 100% | RBACæ¼”ç¤º |
| **è¯ä¹¦ç®¡ç†** | `POST /api/v1/ca/root` | âœ… å®Œæˆ | 100% | æ ¹CAç”Ÿæˆ |
| | `GET /api/v1/ca/root/certificate` | âœ… å®Œæˆ | 100% | æ ¹CAå¯¼å‡º |
| | `POST /api/v1/ca/certificates/issue` | âœ… å®Œæˆ | 100% | è¯ä¹¦ç­¾å‘ |
| | `POST /api/v1/ca/certificates/import` | âœ… å®Œæˆ | 100% | è¯ä¹¦å¯¼å…¥ |
| | `GET /api/v1/ca/certificates` | âœ… å®Œæˆ | 100% | è¯ä¹¦åˆ—è¡¨ |
| | `POST /api/v1/ca/certificates/{id}/revoke` | âœ… å®Œæˆ | 100% | è¯ä¹¦åŠé”€ |
| | `POST /api/v1/ca/crl` | âœ… å®Œæˆ | 100% | CRLç”Ÿæˆ |
| | `GET /api/v1/ca/crl` | âœ… å®Œæˆ | 100% | CRLåˆ—è¡¨ |
| **PDFç­¾ç« ** | `POST /api/v1/pdf/sign` | âœ… å®Œæˆ | 100% | å•ä¸ªç­¾ç«  |
| | `POST /api/v1/pdf/sign/batch` | âœ… å®Œæˆ | 100% | æ‰¹é‡ç­¾ç«  |
| | `POST /api/v1/pdf/verify` | âœ… å®Œæˆ | 100% | éªŒç­¾ |
| | `GET /api/v1/pdf/seals` | âŒ **ç¼ºå¤±** | 0% | **ã€P0ä»»åŠ¡ã€‘** |
| | `POST /api/v1/pdf/seals` | âŒ **ç¼ºå¤±** | 0% | **ã€P0ä»»åŠ¡ã€‘** |
| | `DELETE /api/v1/pdf/seals/{id}` | âŒ **ç¼ºå¤±** | 0% | **ã€P0ä»»åŠ¡ã€‘** |
| | `GET /api/v1/pdf/seals/{id}/image` | âŒ **ç¼ºå¤±** | 0% | **ã€P0ä»»åŠ¡ã€‘** |
| **å®¡è®¡æ—¥å¿—** | `GET /api/v1/audit/logs` | âœ… å®Œæˆ | 100% | æ—¥å¿—æŸ¥è¯¢ |
| **ç”¨æˆ·ç®¡ç†** | `GET /api/v1/users` | âŒ **ç¼ºå¤±** | 0% | **ã€P1ä»»åŠ¡ã€‘** |
| | `POST /api/v1/users` | âŒ **ç¼ºå¤±** | 0% | **ã€P1ä»»åŠ¡ã€‘** |
| | `PATCH /api/v1/users/{id}` | âŒ **ç¼ºå¤±** | 0% | **ã€P1ä»»åŠ¡ã€‘** |
| | `DELETE /api/v1/users/{id}` | âŒ **ç¼ºå¤±** | 0% | **ã€P1ä»»åŠ¡ã€‘** |
| **ç³»ç»Ÿ** | `GET /health` | âœ… å®Œæˆ | 100% | å¥åº·æ£€æŸ¥ |

**APIå®Œæˆåº¦ç»Ÿè®¡**:
- æ€»ç«¯ç‚¹æ•°: 28 ä¸ª
- å·²å®Œæˆ: 20 ä¸ª (71%)
- ç¼ºå¤±: 8 ä¸ª (29%)
  - P0 (å¿…é¡»): 4 ä¸ª (Seal API)
  - P1 (åº”è¯¥): 4 ä¸ª (ç”¨æˆ·ç®¡ç†)

---

## ğŸ¯ P0 ä»»åŠ¡ï¼šSealï¼ˆä¼ä¸šå°ç« ï¼‰APIå®ç°

### ä¼˜å…ˆçº§
ğŸ”´ **æœ€é«˜ - å‰ç«¯åŠŸèƒ½ä¾èµ–ï¼Œå¿…é¡»åœ¨ç¬¬ä¸€å‘¨å®Œæˆ**

### ä»»åŠ¡æè¿°
å®ç°å®Œæ•´çš„ä¼ä¸šå°ç« (Seal)ç®¡ç†APIï¼Œä½¿å‰ç«¯å°ç« ä¸Šä¼ ã€æŸ¥çœ‹ã€åˆ é™¤ç­‰åŠŸèƒ½èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚

### å½“å‰çŠ¶æ€åˆ†æ

**å·²æœ‰çš„åŸºç¡€**:
- âœ“ æ•°æ®åº“è¡¨: `seals` (id, owner_id, name, description, image_file_id, image_secret_id, ...)
- âœ“ æ•°æ®åº“è¡¨: `file_metadata` (æ–‡ä»¶å…ƒæ•°æ®)
- âœ“ æ•°æ®åº“è¡¨: `encrypted_secrets` (åŠ å¯†å­˜å‚¨)
- âœ“ CRUDæ“ä½œ: `/backend/app/crud/seal.py` (create, get, list, delete)
- âœ“ å‰ç«¯APIå®¢æˆ·ç«¯: `/frontend/src/lib/sealApi.ts` (å®Œæ•´å®ç°ï¼Œç­‰å¾…åç«¯)
- âœ“ å‰ç«¯UIç»„ä»¶: `/frontend/src/components/seals/SealUploadManager.tsx` (å®Œæ•´å®ç°)
- âœ“ å­˜å‚¨æœåŠ¡: `EncryptedStorageService` (åŠ å¯†å­˜å‚¨)

**ç¼ºå¤±çš„éƒ¨åˆ†**:
- âŒ APIç«¯ç‚¹æ–‡ä»¶: `/backend/app/api/endpoints/seals.py` (ä¸å­˜åœ¨)
- âŒ è·¯ç”±æ³¨å†Œ: `routes.py` ä¸­æœªæ³¨å†Œsealsè·¯ç”±
- âŒ 4ä¸ªAPIç«¯ç‚¹å®ç°

### å…·ä½“ä»»åŠ¡ç»†åˆ†

#### ä»»åŠ¡ 1.1: åˆ›å»º seals.py ç«¯ç‚¹æ–‡ä»¶
**æ–‡ä»¶**: `/backend/app/api/endpoints/seals.py`  
**å·¥ä½œé‡**: ~80 è¡Œä»£ç 

**éœ€è¦å®ç°çš„å†…å®¹**:
```python
# å¯¼å…¥å¿…è¦çš„åº“
from fastapi import APIRouter, Depends, UploadFile, HTTPException, status
from sqlalchemy.ext.asyncio import AsyncSession
from uuid import UUID

# åˆ›å»ºè·¯ç”±å™¨
router = APIRouter(prefix="/pdf/seals", tags=["seals"])

# 4ä¸ªç«¯ç‚¹å‡½æ•°
```

**å…·ä½“ç«¯ç‚¹**:

1. **POST /api/v1/pdf/seals - ä¸Šä¼ å°ç« **
   - å‚æ•°: 
     - `file` (UploadFile): PNG/SVGå›¾ç‰‡
     - `name` (str): å°ç« åç§°
     - `description` (str, optional): æè¿°
   - å“åº”: 
     ```json
     {
       "seal_id": "uuid",
       "name": "å…¬å¸å°ç« ",
       "description": "...",
       "content_type": "image/png",
       "size_bytes": 12345,
       "created_at": "2024-01-01T00:00:00Z",
       "updated_at": "2024-01-01T00:00:00Z"
     }
     ```
   - æƒé™: éœ€è®¤è¯ç”¨æˆ·
   - ä¸šåŠ¡é€»è¾‘:
     - éªŒè¯æ–‡ä»¶ç±»å‹ (PNG/SVG)
     - éªŒè¯æ–‡ä»¶å¤§å° (é»˜è®¤1MB)
     - åŠ å¯†å­˜å‚¨æ–‡ä»¶å†…å®¹
     - ä¿å­˜æ–‡ä»¶å…ƒæ•°æ®
     - è®°å½•å®¡è®¡æ—¥å¿—

2. **GET /api/v1/pdf/seals - åˆ—å‡ºç”¨æˆ·å°ç« **
   - å‚æ•°: (æ— )
   - å“åº”:
     ```json
     {
       "seals": [
         {"seal_id": "...", "name": "...", ...}
       ]
     }
     ```
   - æƒé™: éœ€è®¤è¯ç”¨æˆ·
   - ä¸šåŠ¡é€»è¾‘:
     - åˆ—å‡ºå½“å‰ç”¨æˆ·æ‰€æœ‰å°ç« 
     - æŒ‰åˆ›å»ºæ—¶é—´å€’åº
     - åŒ…å«ä¸‹è½½URLï¼ˆå¯é€‰ï¼‰

3. **DELETE /api/v1/pdf/seals/{seal_id} - åˆ é™¤å°ç« **
   - å‚æ•°: seal_id (path)
   - å“åº”: `{"detail": "Successfully deleted"}`
   - æƒé™: éœ€è®¤è¯ç”¨æˆ·ï¼ˆä»…åˆ é™¤è‡ªå·±çš„å°ç« ï¼‰
   - ä¸šåŠ¡é€»è¾‘:
     - éªŒè¯æ‰€æœ‰æƒ
     - åˆ é™¤å…³è”çš„æ–‡ä»¶å’ŒåŠ å¯†æ•°æ®
     - è®°å½•å®¡è®¡æ—¥å¿—

4. **GET /api/v1/pdf/seals/{seal_id}/image - ä¸‹è½½å°ç« å›¾ç‰‡**
   - å‚æ•°: seal_id (path)
   - å“åº”: å›¾ç‰‡äºŒè¿›åˆ¶æµ (PNG/SVG)
   - æƒé™: éœ€è®¤è¯ç”¨æˆ·
   - ä¸šåŠ¡é€»è¾‘:
     - éªŒè¯æ‰€æœ‰æƒ
     - ä»åŠ å¯†å­˜å‚¨è§£å¯†
     - è¿”å›æ­£ç¡®çš„ Content-Type

#### ä»»åŠ¡ 1.2: æ³¨å†Œè·¯ç”±
**æ–‡ä»¶**: `/backend/app/api/routes.py`  
**å·¥ä½œé‡**: ~1 è¡Œä»£ç 

ä¿®æ”¹å†…å®¹:
```python
from app.api.endpoints import audit, auth, ca, pdf_signing, seals  # â† æ·»åŠ sealså¯¼å…¥

# ...

api_router.include_router(seals.router)  # â† æ·»åŠ è¿™ä¸€è¡Œ
```

#### ä»»åŠ¡ 1.3: å®ç°å­˜å‚¨å’Œæƒé™æ£€æŸ¥
**æ–‡ä»¶**: å·²æœ‰ `/backend/app/crud/seal.py` å’Œå­˜å‚¨æœåŠ¡  
**å·¥ä½œé‡**: åˆ©ç”¨ç°æœ‰ä»£ç ï¼Œæ— éœ€æ–°å»º

**ä½¿ç”¨çš„æœåŠ¡**:
- `EncryptedStorageService`: åŠ å¯†å­˜å‚¨æ–‡ä»¶
- `seal_crud`: CRUDæ“ä½œ
- `audit_log_crud`: å®¡è®¡æ—¥å¿—

#### ä»»åŠ¡ 1.4: æ·»åŠ å•å…ƒæµ‹è¯•
**æ–‡ä»¶**: `/backend/tests/api/endpoints/test_seals.py` (æ–°å»º)  
**å·¥ä½œé‡**: ~200 è¡Œä»£ç 

**æµ‹è¯•ç”¨ä¾‹**:
- ä¸Šä¼ æœ‰æ•ˆå°ç«  (PNG/SVG)
- æ‹’ç»æ— æ•ˆæ–‡ä»¶ç±»å‹
- æ‹’ç»è¶…å¤§æ–‡ä»¶
- åˆ—è¡¨è¿”å›æ­£ç¡®çš„å°ç« 
- åˆ é™¤æƒé™æ£€æŸ¥
- ä¸‹è½½å›¾ç‰‡å†…å®¹éªŒè¯

### å·¥ä½œæµç¨‹
1. åˆ›å»º `seals.py` ç«¯ç‚¹æ–‡ä»¶ (2å°æ—¶)
2. å®ç°4ä¸ªAPIç«¯ç‚¹ (3å°æ—¶)
3. ä¿®æ”¹ `routes.py` æ³¨å†Œè·¯ç”± (30åˆ†é’Ÿ)
4. æœ¬åœ°æµ‹è¯•éªŒè¯ (2å°æ—¶)
5. æ·»åŠ å•å…ƒæµ‹è¯• (2å°æ—¶)
6. é›†æˆæµ‹è¯•ä¸å‰ç«¯è”è°ƒ (1å°æ—¶)

**æ€»è€—æ—¶**: 1-2 å¤©

### éªŒæ”¶æ ‡å‡†
- [ ] 4ä¸ªAPIç«¯ç‚¹å…¨éƒ¨å®ç°
- [ ] å‰ç«¯èƒ½æˆåŠŸè°ƒç”¨è¿™äº›ç«¯ç‚¹
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–æ‰€æœ‰ç«¯ç‚¹
- [ ] å®¡è®¡æ—¥å¿—æ­£ç¡®è®°å½•æ“ä½œ
- [ ] æ–‡ä»¶åŠ å¯†å­˜å‚¨ç”Ÿæ•ˆ
- [ ] æƒé™æ£€æŸ¥æ­£ç¡® (ç”¨æˆ·åªèƒ½æ“ä½œè‡ªå·±çš„å°ç« )

---

## ğŸ¯ P1 ä»»åŠ¡ï¼šç”¨æˆ·ç®¡ç†åŠŸèƒ½

### ä¼˜å…ˆçº§
ğŸŸ  **é«˜ - å¤šç”¨æˆ·æ”¯æŒå¿…éœ€ï¼Œå»ºè®®ç¬¬äºŒå‘¨å®Œæˆ**

### å½“å‰çŠ¶æ€åˆ†æ
- âœ“ ç”¨æˆ·è¡¨ç»“æ„å®Œæ•´ (`users` è¡¨)
- âœ“ åŸºç¡€CRUDå­˜åœ¨ (`/backend/app/crud/user.py`)
- âœ“ è®¤è¯ç³»ç»Ÿå®Œæ•´
- âŒ APIç«¯ç‚¹ç¼ºå¤±
- âŒ å‰ç«¯ç®¡ç†é¡µé¢æ˜¯å ä½ç¬¦

### ä»»åŠ¡ç»†åˆ†

#### å­ä»»åŠ¡ 2.1: ç”¨æˆ·ç®¡ç†APIç«¯ç‚¹
**éœ€è¦å®ç°çš„ç«¯ç‚¹**:

1. **GET /api/v1/users - ç”¨æˆ·åˆ—è¡¨** (ä»…ç®¡ç†å‘˜)
   - å‚æ•°: limit, offset, email_filter (å¯é€‰)
   - å“åº”: ç”¨æˆ·åˆ—è¡¨ + æ€»æ•°

2. **POST /api/v1/users - åˆ›å»ºç”¨æˆ·** (ä»…ç®¡ç†å‘˜)
   - å‚æ•°: email, password, role (user/admin)
   - å“åº”: æ–°ç”¨æˆ·ä¿¡æ¯

3. **GET /api/v1/users/{user_id} - ç”¨æˆ·è¯¦æƒ…** (è‡ªå·±æˆ–ç®¡ç†å‘˜)
   - å‚æ•°: user_id
   - å“åº”: ç”¨æˆ·å®Œæ•´ä¿¡æ¯

4. **PATCH /api/v1/users/{user_id} - ç¼–è¾‘ç”¨æˆ·** (ä»…ç®¡ç†å‘˜)
   - å‚æ•°: email (å¯é€‰), is_active (å¯é€‰), role (å¯é€‰)
   - å“åº”: æ›´æ–°åçš„ç”¨æˆ·ä¿¡æ¯

5. **DELETE /api/v1/users/{user_id} - åˆ é™¤ç”¨æˆ·** (ä»…ç®¡ç†å‘˜)
   - å‚æ•°: user_id
   - ä¸šåŠ¡é€»è¾‘: è½¯åˆ é™¤æˆ–ç¡¬åˆ é™¤ç­–ç•¥
   - å“åº”: ç¡®è®¤åˆ é™¤

6. **POST /api/v1/users/{user_id}/reset-password** (ä»…ç®¡ç†å‘˜)
   - å‚æ•°: new_password
   - å“åº”: ç¡®è®¤é‡ç½®

7. **POST /api/v1/users/{user_id}/toggle-active** (ä»…ç®¡ç†å‘˜)
   - å‚æ•°: (æ— )
   - å“åº”: æ›´æ–°åçš„æ´»è·ƒçŠ¶æ€

**å·¥ä½œé‡**: ~400 è¡Œä»£ç 

#### å­ä»»åŠ¡ 2.2: å‰ç«¯ç”¨æˆ·ç®¡ç†é¡µé¢
**æ–‡ä»¶**: `/frontend/src/pages/dashboard/UsersManagementPage.tsx` (æ–°å»º)

**åŒ…å«çš„åŠŸèƒ½**:
- ç”¨æˆ·è¡¨æ ¼ (åˆ—è¡¨ã€åˆ†é¡µã€æœç´¢)
- åˆ›å»ºç”¨æˆ·è¡¨å•
- ç¼–è¾‘ç”¨æˆ·è¡¨å•
- åˆ é™¤ç”¨æˆ·ç¡®è®¤å¯¹è¯æ¡†
- é‡ç½®å¯†ç åŠŸèƒ½
- ç”¨æˆ·çŠ¶æ€åˆ‡æ¢ (å¯ç”¨/ç¦ç”¨)

**å·¥ä½œé‡**: ~300 è¡Œä»£ç 

#### å­ä»»åŠ¡ 2.3: APIå®¢æˆ·ç«¯
**æ–‡ä»¶**: `/frontend/src/lib/usersApi.ts` (æ–°å»º)

**åŒ…å«çš„å‡½æ•°**:
- `listUsers()`
- `getUser(id)`
- `createUser()`
- `updateUser()`
- `deleteUser()`
- `resetPassword()`
- `toggleUserActive()`

**å·¥ä½œé‡**: ~150 è¡Œä»£ç 

### æ€»å·¥ä½œé‡
- åç«¯: 400 è¡Œä»£ç  + æµ‹è¯•
- å‰ç«¯: 450 è¡Œä»£ç  + æµ‹è¯•
- **æ€»è®¡**: ~3-4 å¤©

---

## ğŸ¯ P2 ä»»åŠ¡ï¼šåŠŸèƒ½å®Œå–„ä¸ä¼˜åŒ–

### 2.1 é”™è¯¯å¤„ç†æ ‡å‡†åŒ–
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

**ä»»åŠ¡**:
- ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼
- è¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯
- å‰ç«¯é”™è¯¯æç¤ºæ”¹è¿›

**å·¥ä½œé‡**: 1-2 å¤©

### 2.2 æ–‡ä»¶éªŒè¯åŠ å¼º
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

**ä»»åŠ¡**:
- PDFæ–‡ä»¶éªŒè¯ (æ ¼å¼ã€å¤§å°ã€æ˜¯å¦å·²ç­¾)
- å°ç« æ–‡ä»¶éªŒè¯ (å›¾ç‰‡å®Œæ•´æ€§)
- è¯ä¹¦æ–‡ä»¶éªŒè¯ (PKCS#12æœ‰æ•ˆæ€§)

**å·¥ä½œé‡**: 1 å¤©

### 2.3 å¯¼å‡ºåŠŸèƒ½
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

**ä»»åŠ¡**:
- å®¡è®¡æ—¥å¿—å¯¼å‡º (CSV/JSON)
- è¯ä¹¦æ‰¹é‡å¯¼å‡º
- ç­¾ç« è®°å½•å¯¼å‡º

**å·¥ä½œé‡**: 2-3 å¤©

### 2.4 æ‰¹é‡æ“ä½œ
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

**ä»»åŠ¡**:
- æ‰¹é‡åˆ›å»ºç”¨æˆ· (CSVå¯¼å…¥)
- æ‰¹é‡ç­¾å‘è¯ä¹¦
- æ‰¹é‡åŠé”€è¯ä¹¦

**å·¥ä½œé‡**: 2-3 å¤©

---

## ğŸ¯ P3 ä»»åŠ¡ï¼šé«˜çº§åŠŸèƒ½

### 3.1 ç­¾ç« æ¨¡æ¿
**ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

**æè¿°**: ä¿å­˜ç­¾ç« å‚æ•°ç»„åˆä¸ºæ¨¡æ¿ï¼Œå¿«é€Ÿå¤ç”¨

**å·¥ä½œé‡**: 3-4 å¤©

### 3.2 å­˜å‚¨æ‰©å±•
**ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

**æè¿°**: æ”¯æŒS3/OSSå­˜å‚¨å¤§å‹PDFæ–‡ä»¶

**å·¥ä½œé‡**: 4-5 å¤©

### 3.3 å›½é™…åŒ–æ”¯æŒ
**ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

**æè¿°**: å¤šè¯­è¨€æ”¯æŒ (ä¸­æ–‡/è‹±æ–‡/æ—¥æ–‡ç­‰)

**å·¥ä½œé‡**: 2-3 å¤©

### 3.4 æ·±è‰²ä¸»é¢˜å®Œå–„
**ä¼˜å…ˆçº§**: ğŸŸ¢ ä½

**å·¥ä½œé‡**: 1 å¤©

---

## ğŸ“Š å¼€å‘æ—¶é—´è¡¨

### ç¬¬1å‘¨ (ä¼˜å…ˆçº§ P0)

| å¤©æ¬¡ | ä»»åŠ¡ | æ—¶é•¿ | äº¤ä»˜ç‰© |
|------|------|------|--------|
| å‘¨ä¸€ | Seal API å®ç° (1-3) | 6h | seals.py, æµ‹è¯• |
| å‘¨äºŒ | Seal API è”è°ƒ + ä¼˜åŒ– | 4h | å‰ç«¯å¯ç”¨ |
| å‘¨ä¸‰ | é”™è¯¯å¤„ç†æ”¹è¿› | 4h | æ ‡å‡†é”™è¯¯å“åº” |
| å‘¨å›› | æ–‡ä»¶éªŒè¯åŠ å¼º | 4h | éªŒè¯è§„åˆ™ |
| å‘¨äº” | ç¼ºé™·ä¿®å¤ + ä¼˜åŒ– | 4h | ç¨³å®šç‰ˆæœ¬ |

**ç¬¬1å‘¨äº¤ä»˜**: âœ… Seal API å®Œæ•´å¯ç”¨ + åŸºç¡€ä¼˜åŒ–

### ç¬¬2å‘¨ (ä¼˜å…ˆçº§ P1)

| å¤©æ¬¡ | ä»»åŠ¡ | æ—¶é•¿ | äº¤ä»˜ç‰© |
|------|------|------|--------|
| å‘¨ä¸€ | ç”¨æˆ·ç®¡ç†API (2.1) | 6h | endpoints/users.py |
| å‘¨äºŒ | ç”¨æˆ·ç®¡ç†API å®Œå–„ | 4h | å®Œæ•´æµ‹è¯• |
| å‘¨ä¸‰ | å‰ç«¯ç®¡ç†é¡µé¢ (2.2-2.3) | 6h | UsersManagementPage |
| å‘¨å›› | å‰ç«¯è”è°ƒ + æµ‹è¯• | 4h | åŠŸèƒ½å®Œæ•´ |
| å‘¨äº” | é›†æˆæµ‹è¯• + æ–‡æ¡£ | 4h | ç¨³å®šç‰ˆæœ¬ |

**ç¬¬2å‘¨äº¤ä»˜**: âœ… å¤šç”¨æˆ·ç®¡ç†åŠŸèƒ½å®Œæ•´

### ç¬¬3-4å‘¨ (ä¼˜å…ˆçº§ P2 + P3)

åŸºäºéœ€æ±‚æ‹©å–å®ç°é«˜çº§åŠŸèƒ½

---

## ğŸ“ å®ç°æ£€æŸ¥æ¸…å•

### Seal API å®ç°æ¸…å•
- [ ] åˆ›å»º `/backend/app/api/endpoints/seals.py`
- [ ] å®ç° POST /seals (ä¸Šä¼ )
- [ ] å®ç° GET /seals (åˆ—è¡¨)
- [ ] å®ç° DELETE /seals/{id} (åˆ é™¤)
- [ ] å®ç° GET /seals/{id}/image (ä¸‹è½½)
- [ ] ä¿®æ”¹ `routes.py` æ³¨å†Œè·¯ç”±
- [ ] æ·»åŠ å•å…ƒæµ‹è¯•
- [ ] å‰ç«¯è”è°ƒéªŒè¯
- [ ] å®¡è®¡æ—¥å¿—è®°å½•
- [ ] æƒé™æ£€æŸ¥å®Œæ•´

### ç”¨æˆ·ç®¡ç†å®ç°æ¸…å•
- [ ] åˆ›å»º `/backend/app/api/endpoints/users.py`
- [ ] å®ç° 7 ä¸ªç”¨æˆ·ç®¡ç†ç«¯ç‚¹
- [ ] åˆ›å»ºå‰ç«¯ UsersManagementPage é¡µé¢
- [ ] åˆ›å»º usersApi.ts å®¢æˆ·ç«¯
- [ ] æ·»åŠ å•å…ƒæµ‹è¯• (åç«¯ + å‰ç«¯)
- [ ] é›†æˆåˆ°è·¯ç”±å¯¼èˆª
- [ ] æƒé™éªŒè¯ (ä»…ç®¡ç†å‘˜)
- [ ] å®¡è®¡æ—¥å¿—è®°å½•
- [ ] é”™è¯¯å¤„ç†å®Œå–„

---

## ğŸ”— ç›¸å…³æ–‡ä»¶å‚è€ƒ

### ç°æœ‰çš„ç±»ä¼¼å®ç°å‚è€ƒ

**åç«¯APIç«¯ç‚¹å‚è€ƒ**:
- `/backend/app/api/endpoints/auth.py` (165è¡Œ) - è®¤è¯ç«¯ç‚¹
- `/backend/app/api/endpoints/ca.py` (337è¡Œ) - è¯ä¹¦ç®¡ç†ç«¯ç‚¹
- `/backend/app/api/endpoints/audit.py` (62è¡Œ) - å®¡è®¡æ—¥å¿—ç«¯ç‚¹

**CRUDæ“ä½œå‚è€ƒ**:
- `/backend/app/crud/user.py` - ç”¨æˆ·CRUD
- `/backend/app/crud/certificate.py` - è¯ä¹¦CRUD
- `/backend/app/crud/seal.py` - **å°ç« CRUD (å·²æœ‰)**

**å‰ç«¯é¡µé¢å‚è€ƒ**:
- `/frontend/src/pages/dashboard/CertificatesPage.tsx` - è¯ä¹¦ç®¡ç†
- `/frontend/src/pages/dashboard/AuditLogPage.tsx` - å®¡è®¡æ—¥å¿—

**å‰ç«¯APIå®¢æˆ·ç«¯å‚è€ƒ**:
- `/frontend/src/lib/caApi.ts` - è¯ä¹¦API
- `/frontend/src/lib/signingApi.ts` - ç­¾ç« API

---

## ğŸ å¿«é€Ÿå¼€å§‹å‘½ä»¤

```bash
# è¿è¡Œåç«¯
cd backend
poetry run uvicorn app.main:app --reload

# è¿è¡Œæµ‹è¯•
poetry run pytest tests/api/endpoints/ -v

# è¿è¡Œå‰ç«¯
cd frontend
npm run dev

# æ„å»ºDockeré•œåƒ
docker-compose build backend

# å¯åŠ¨å®Œæ•´æ ˆ
./deploy.sh up
```

---

## âœ… è´¨é‡é—¨æ§›

æ‰€æœ‰PRå¿…é¡»æ»¡è¶³:
1. âœ“ ä»£ç æ ¼å¼: `black` + `isort`
2. âœ“ ç±»å‹æ£€æŸ¥: `mypy --strict` (åç«¯)
3. âœ“ ESLint: å‰ç«¯lintingé€šè¿‡
4. âœ“ æµ‹è¯•è¦†ç›–: â‰¥80% å¯¹å…³é”®åŠŸèƒ½
5. âœ“ å®¡è®¡æ—¥å¿—: å…³é”®æ“ä½œè®°å½•å®Œæ•´
6. âœ“ æƒé™æ£€æŸ¥: RBACé€»è¾‘æ­£ç¡®
7. âœ“ é”™è¯¯å¤„ç†: é¢„æœŸé”™è¯¯éƒ½æœ‰å¤„ç†

---

## ğŸ“ é—®é¢˜æ’æŸ¥æŒ‡å—

### å¸¸è§é—®é¢˜

**Q: å¦‚ä½•æµ‹è¯•APIç«¯ç‚¹?**
```bash
# ä½¿ç”¨FastAPI Swaggeræ–‡æ¡£
http://localhost:8000/docs

# æˆ–ä½¿ç”¨curl
curl -X GET http://localhost:8000/api/v1/pdf/seals \
  -H "Authorization: Bearer <token>"
```

**Q: å‰ç«¯è°ƒç”¨APIå¤±è´¥?**
æ£€æŸ¥:
1. åç«¯æ˜¯å¦è¿è¡Œ (`http://localhost:8000/health`)
2. Tokenæ˜¯å¦æœ‰æ•ˆ (æ£€æŸ¥æµè§ˆå™¨Consoleçš„Authorization header)
3. CORSé…ç½®æ˜¯å¦æ­£ç¡® (`.env`ä¸­çš„BACKEND_CORS_ORIGINS)

**Q: æ•°æ®åº“è¿ç§»å¤±è´¥?**
```bash
# é‡ç½®æ•°æ®åº“
poetry run alembic downgrade base
poetry run alembic upgrade head
```

---

## æ€»ç»“

è¿™ä»½roadmapæä¾›äº†:
1. âœ“ å®Œæ•´çš„åŠŸèƒ½çŠ¶æ€åˆ†æ (71% å®Œæˆ)
2. âœ“ ä¼˜å…ˆçº§æ’åº (P0/P1/P2/P3)
3. âœ“ è¯¦ç»†çš„ä»»åŠ¡åˆ†è§£
4. âœ“ æ—¶é—´ä¼°ç®—
5. âœ“ éªŒæ”¶æ ‡å‡†
6. âœ“ å®ç°å‚è€ƒ

**ç«‹å³è¡ŒåŠ¨**: å¼€å§‹å®ç°P0ä»»åŠ¡ (Seal API)ï¼Œé¢„è®¡2-3å¤©å¯å®Œæˆã€‚
